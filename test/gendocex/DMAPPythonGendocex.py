import numpy as np
import numpy.matlib as ml
import matplotlib.pyplot as plt
import butools
from butools.utils import *
from butools.ph import *
from butools.dph import *
from butools.map import *
from butools.moments import *
from butools.reptrans import*
from butools.mc import *
from butools.dmap import *
from contextlib import redirect_stdout

def DMAPPythonGendocex():
	print('---BuTools: DMAP package test file---')
	print('Enable the verbose messages with the BuToolsVerbose flag')
	butools.verbose = True
	print('Enable input parameter checking with the BuToolsCheckInput flag')
	butools.checkInput = True
	np.set_printoptions(precision=5,linewidth=1024)
	outFile = open('DMAP_python.docex','w')
	with redirect_stdout(outFile):
		print('=== MarginalDistributionFromDMAP ===')
		print('>>> D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> a,A = MarginalDistributionFromDMAP(D0,D1)')
		a,A = MarginalDistributionFromDMAP(D0,D1)
		print('>>> print(a)')
		print(a)
		print('>>> print(A)')
		print(A)
		print('=== MarginalMomentsFromDMAP ===')
		print('>>> D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> moms = MarginalMomentsFromDMAP(D0,D1)')
		moms = MarginalMomentsFromDMAP(D0,D1)
		print('>>> print(moms)')
		print(moms)
		print('=== MarginalDistributionFromDRAP ===')
		print('>>> H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> a,A = MarginalDistributionFromDRAP(H0,H1)')
		a,A = MarginalDistributionFromDRAP(H0,H1)
		print('>>> print(a)')
		print(a)
		print('>>> print(A)')
		print(A)
		print('=== MarginalMomentsFromDRAP ===')
		print('>>> H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> moms = MarginalMomentsFromDRAP(H0,H1)')
		moms = MarginalMomentsFromDRAP(H0,H1)
		print('>>> print(moms)')
		print(moms)
		print('=== MarginalDistributionFromDMMAP ===')
		print('>>> D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])')
		D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])
		print('>>> D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])')
		D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])
		print('>>> D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])')
		D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])
		print('>>> D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])')
		D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])
		print('>>> a,A = MarginalDistributionFromDMMAP([D0,D1,D2,D3])')
		a,A = MarginalDistributionFromDMMAP([D0,D1,D2,D3])
		print('>>> print(a)')
		print(a)
		print('>>> print(A)')
		print(A)
		print('=== MarginalMomentsFromDMMAP ===')
		print('>>> D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])')
		D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])
		print('>>> D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])')
		D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])
		print('>>> D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])')
		D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])
		print('>>> D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])')
		D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])
		print('>>> moms = MarginalMomentsFromDMMAP([D0,D1,D2,D3])')
		moms = MarginalMomentsFromDMMAP([D0,D1,D2,D3])
		print('>>> print(moms)')
		print(moms)
		print('=== MarginalDistributionFromDMRAP ===')
		print('>>> H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])')
		H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])
		print('>>> H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])')
		H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])
		print('>>> H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])')
		H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])
		print('>>> a,A = MarginalDistributionFromDMRAP([H0,H1,H2])')
		a,A = MarginalDistributionFromDMRAP([H0,H1,H2])
		print('>>> print(a)')
		print(a)
		print('>>> print(A)')
		print(A)
		print('=== MarginalMomentsFromDMRAP ===')
		print('>>> H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])')
		H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])
		print('>>> H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])')
		H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])
		print('>>> H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])')
		H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])
		print('>>> moms = MarginalMomentsFromDMRAP([H0,H1,H2])')
		moms = MarginalMomentsFromDMRAP([H0,H1,H2])
		print('>>> print(moms)')
		print(moms)
		print('=== LagCorrelationsFromDMAP ===')
		print('>>> D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> corr = LagCorrelationsFromDMAP(D0,D1,3)')
		corr = LagCorrelationsFromDMAP(D0,D1,3)
		print('>>> print(corr)')
		print(corr)
		print('=== LagCorrelationsFromDRAP ===')
		print('>>> H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> corr = LagCorrelationsFromDRAP(H0,H1,3)')
		corr = LagCorrelationsFromDRAP(H0,H1,3)
		print('>>> print(corr)')
		print(corr)
		print('=== LagkJointMomentsFromDMAP ===')
		print('>>> D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> Nm = LagkJointMomentsFromDMAP(D0,D1,4,1)')
		Nm = LagkJointMomentsFromDMAP(D0,D1,4,1)
		print('>>> print(Nm)')
		print(Nm)
		print('>>> moms = MarginalMomentsFromDMAP(D0,D1,4)')
		moms = MarginalMomentsFromDMAP(D0,D1,4)
		print('>>> print(moms)')
		print(moms)
		print('>>> cjm=np.empty(3)')
		cjm=np.empty(3)
		print('>>> for i in range(3):')
		for i in range(3):
		    print('>>>     Nx=LagkJointMomentsFromDMAP(D0,D1,1,i+1)')
		    Nx=LagkJointMomentsFromDMAP(D0,D1,1,i+1)
		    print('>>>     cjm[i] = (Nx[1,1]-moms[0]**2) / (moms[1]-moms[0]**2)')
		    cjm[i] = (Nx[1,1]-moms[0]**2) / (moms[1]-moms[0]**2)
		print('>>> print(cjm)')
		print(cjm)
		print('>>> corr = LagCorrelationsFromDMAP(D0,D1,3)')
		corr = LagCorrelationsFromDMAP(D0,D1,3)
		print('>>> print(corr)')
		print(corr)
		mNm1, mNm2 = Nm[0,1:].A.flatten(), Nm[1:,0].A.flatten()
		print('=== LagkJointMomentsFromDRAP ===')
		print('>>> H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> Nm = LagkJointMomentsFromDRAP(H0,H1,4,1)')
		Nm = LagkJointMomentsFromDRAP(H0,H1,4,1)
		print('>>> print(Length(Nm))')
		print(Length(Nm))
		print('>>> moms = MarginalMomentsFromDRAP(H0,H1,4)')
		moms = MarginalMomentsFromDRAP(H0,H1,4)
		print('>>> print(moms)')
		print(moms)
		print('>>> cjm=np.empty(3)')
		cjm=np.empty(3)
		print('>>> for i in range(3):')
		for i in range(3):
		    print('>>>     Nx=LagkJointMomentsFromDRAP(H0,H1,1,i+1)')
		    Nx=LagkJointMomentsFromDRAP(H0,H1,1,i+1)
		    print('>>>     cjm[i] = (Nx[1,1]-moms[0]**2) / (moms[1]-moms[0]**2)')
		    cjm[i] = (Nx[1,1]-moms[0]**2) / (moms[1]-moms[0]**2)
		print('>>> print(cjm)')
		print(cjm)
		print('>>> corr = LagCorrelationsFromDRAP(H0,H1,3)')
		corr = LagCorrelationsFromDRAP(H0,H1,3)
		print('>>> print(corr)')
		print(corr)
		mNm1, mNm2 = Nm[0,1:].A.flatten(), Nm[1:,0].A.flatten()
		print('=== LagkJointMomentsFromDMMAP ===')
		print('>>> D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])')
		D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])
		print('>>> D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])')
		D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])
		print('>>> D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])')
		D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])
		print('>>> D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])')
		D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])
		print('>>> Nm = LagkJointMomentsFromDMMAP([D0,D1,D2,D3],3,1)')
		Nm = LagkJointMomentsFromDMMAP([D0,D1,D2,D3],3,1)
		print('>>> print(Nm[0])')
		print(Nm[0])
		print('>>> print(Nm[1])')
		print(Nm[1])
		print('>>> print(Nm[2])')
		print(Nm[2])
		print('=== LagkJointMomentsFromDMRAP ===')
		print('>>> H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])')
		H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])
		print('>>> H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])')
		H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])
		print('>>> H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])')
		H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])
		print('>>> Nm = LagkJointMomentsFromDMRAP([H0,H1,H2],3,2)')
		Nm = LagkJointMomentsFromDMRAP([H0,H1,H2],3,2)
		print('>>> print(Nm[0])')
		print(Nm[0])
		print('>>> print(Nm[1])')
		print(Nm[1])
		print('=== RandomDMAP ===')
		print('>>> D0,D1 = RandomDMAP(4,5.62,10)')
		D0,D1 = RandomDMAP(4,5.62,10)
		print('>>> print(D0)')
		print(D0)
		print('>>> print(D1)')
		print(D1)
		print('>>> m = MarginalMomentsFromDMAP(D0,D1,1)[0]')
		m = MarginalMomentsFromDMAP(D0,D1,1)[0]
		print('>>> print(m)')
		print(m)
		print('=== RandomDMMAP ===')
		print('>>> D = RandomDMMAP(4,3,5.62,10)')
		D = RandomDMMAP(4,3,5.62,10)
		print('>>> print(D[0])')
		print(D[0])
		print('>>> print(D[1])')
		print(D[1])
		print('>>> print(D[2])')
		print(D[2])
		print('>>> print(D[3])')
		print(D[3])
		print('>>> m = MarginalMomentsFromDMMAP(D,1)[0]')
		m = MarginalMomentsFromDMMAP(D,1)[0]
		print('>>> print(m)')
		print(m)
		print('=== CheckDMAPRepresentation ===')
		print('>>> D0 = ml.matrix([[0, 0.02, 0],[0, 0.17, 0.2],[0.16, 0.17, 0.02]])')
		D0 = ml.matrix([[0, 0.02, 0],[0, 0.17, 0.2],[0.16, 0.17, 0.02]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> flag = CheckDMAPRepresentation(D0,D1)')
		flag = CheckDMAPRepresentation(D0,D1)
		print('>>> print(flag)')
		print(flag)
		print('>>> D0 = ml.matrix([[0, 0.02, 0],[0, 0.17, 0.2],[0.16, 0.17, 0.02]])')
		D0 = ml.matrix([[0, 0.02, 0],[0, 0.17, 0.2],[0.16, 0.17, 0.02]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1],[0.18, 0.07, 0.14],[0.13, 0.15, 0.15]])')
		D1 = ml.matrix([[0, 0.88, 0.1],[0.18, 0.07, 0.14],[0.13, 0.15, 0.15]])
		print('>>> flag = CheckDMAPRepresentation(D0,D1)')
		flag = CheckDMAPRepresentation(D0,D1)
		print('>>> print(flag)')
		print(flag)
		print('>>> D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> flag = CheckDMAPRepresentation(D0,D1)')
		flag = CheckDMAPRepresentation(D0,D1)
		print('>>> print(flag)')
		print(flag)
		print('=== CheckDRAPRepresentation ===')
		print('>>> H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02],[0.2, 0, 0]])')
		H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02],[0.2, 0, 0]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29],[0, 0.8, 0]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29],[0, 0.8, 0]])
		print('>>> flag = CheckDRAPRepresentation(H0,H1)')
		flag = CheckDRAPRepresentation(H0,H1)
		print('>>> print(flag)')
		print(flag)
		print('>>> H0 = ml.matrix([[0.2, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0.2, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> flag = CheckDRAPRepresentation(H0,H1)')
		flag = CheckDRAPRepresentation(H0,H1)
		print('>>> print(flag)')
		print(flag)
		print('>>> H0 = ml.matrix([[-1., 0, 0],[0, -2., 2.],[0, 3., -3.]])')
		H0 = ml.matrix([[-1., 0, 0],[0, -2., 2.],[0, 3., -3.]])
		print('>>> H1 = ml.matrix([[0, 0, 1.],[0, -1., 1.],[1., 0, -1.]])')
		H1 = ml.matrix([[0, 0, 1.],[0, -1., 1.],[1., 0, -1.]])
		print('>>> flag = CheckDRAPRepresentation(H0,H1)')
		flag = CheckDRAPRepresentation(H0,H1)
		print('>>> print(flag)')
		print(flag)
		print('>>> H0 = ml.matrix([[0, 0, 15.],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0, 0, 15.],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -15.],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -15.],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> flag = CheckDRAPRepresentation(H0,H1)')
		flag = CheckDRAPRepresentation(H0,H1)
		print('>>> print(flag)')
		print(flag)
		print('>>> H0 = ml.matrix([[0, 0.5, 0.1],[0, -1.4, 3.1],[0.67, 0, 0.4]])')
		H0 = ml.matrix([[0, 0.5, 0.1],[0, -1.4, 3.1],[0.67, 0, 0.4]])
		print('>>> H1 = ml.matrix([[0, 0.4, 0],[0, -0.2, -0.5],[0.3, -0.7, 0.33]])')
		H1 = ml.matrix([[0, 0.4, 0],[0, -0.2, -0.5],[0.3, -0.7, 0.33]])
		print('>>> flag = CheckDRAPRepresentation(H0,H1)')
		flag = CheckDRAPRepresentation(H0,H1)
		print('>>> print(flag)')
		print(flag)
		print('>>> H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		H0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		H1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> flag = CheckDRAPRepresentation(H0,H1)')
		flag = CheckDRAPRepresentation(H0,H1)
		print('>>> print(flag)')
		print(flag)
		print('=== CheckDMMAPRepresentation ===')
		print('>>> D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])')
		D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])
		print('>>> D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])')
		D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])
		print('>>> D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])')
		D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])
		print('>>> D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])')
		D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])
		print('>>> flag = CheckDMMAPRepresentation([D0,D1,D2,D3])')
		flag = CheckDMMAPRepresentation([D0,D1,D2,D3])
		print('>>> print(flag)')
		print(flag)
		print('=== CheckDMRAPRepresentation ===')
		print('>>> H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])')
		H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.23, 0.17, 0.22],[0.19, 0.15, 0.16]])
		print('>>> H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])')
		H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])
		print('>>> H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])')
		H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.34],[0.06, 0.1, 0]])
		print('>>> flag = CheckDMRAPRepresentation([H0,H1,H2])')
		flag = CheckDMRAPRepresentation([H0,H1,H2])
		print('>>> print(flag)')
		print(flag)
		print('=== DRAPFromMoments ===')
		print('>>> G0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		G0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> G1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		G1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> moms = MarginalMomentsFromDRAP(G0,G1,5)')
		moms = MarginalMomentsFromDRAP(G0,G1,5)
		print('>>> print(moms)')
		print(moms)
		print('>>> Nm = LagkJointMomentsFromDRAP(G0,G1,2,1)')
		Nm = LagkJointMomentsFromDRAP(G0,G1,2,1)
		print('>>> print(Nm)')
		print(Nm)
		print('>>> H0,H1 = DRAPFromMoments(moms,Nm)')
		H0,H1 = DRAPFromMoments(moms,Nm)
		print('>>> print(H0)')
		print(H0)
		print('>>> print(H1)')
		print(H1)
		print('>>> rmoms = MarginalMomentsFromDRAP(H0,H1,5)')
		rmoms = MarginalMomentsFromDRAP(H0,H1,5)
		print('>>> print(rmoms)')
		print(rmoms)
		print('>>> rNm = LagkJointMomentsFromDRAP(H0,H1,2,1)')
		rNm = LagkJointMomentsFromDRAP(H0,H1,2,1)
		print('>>> print(rNm)')
		print(rNm)
		print('=== DMRAPFromMoments ===')
		print('>>> G0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])')
		G0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])
		print('>>> G1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])')
		G1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])
		print('>>> G2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])')
		G2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])
		print('>>> G3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])')
		G3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])
		print('>>> G = [G0,G1,G2,G3]')
		G = [G0,G1,G2,G3]
		print('>>> moms = MarginalMomentsFromDMRAP(G,5)')
		moms = MarginalMomentsFromDMRAP(G,5)
		print('>>> print(moms)')
		print(moms)
		print('>>> Nm = LagkJointMomentsFromDMRAP(G,2,1)')
		Nm = LagkJointMomentsFromDMRAP(G,2,1)
		print('>>> Nm1, Nm2, Nm3 = Nm')
		Nm1, Nm2, Nm3 = Nm
		print('>>> print(Nm1)')
		print(Nm1)
		print('>>> print(Nm2)')
		print(Nm2)
		print('>>> print(Nm3)')
		print(Nm3)
		print('>>> H = DMRAPFromMoments(moms,Nm)')
		H = DMRAPFromMoments(moms,Nm)
		print('>>> print(H[0])')
		print(H[0])
		print('>>> print(H[1])')
		print(H[1])
		print('>>> print(H[2])')
		print(H[2])
		print('>>> print(H[3])')
		print(H[3])
		print('>>> butools.checkPrecision = 10.**-10')
		butools.checkPrecision = 10.**-10
		print('>>> rmoms = MarginalMomentsFromDMRAP(H,5)')
		rmoms = MarginalMomentsFromDMRAP(H,5)
		print('>>> print(rmoms)')
		print(rmoms)
		print('>>> rNm = LagkJointMomentsFromDMRAP(H,2,1)')
		rNm = LagkJointMomentsFromDMRAP(H,2,1)
		print('>>> rNm1, rNm2, rNm3 = rNm')
		rNm1, rNm2, rNm3 = rNm
		print('>>> print(rNm1)')
		print(rNm1)
		print('>>> print(rNm2)')
		print(rNm2)
		print('>>> print(rNm3)')
		print(rNm3)
		print('=== DMAPFromDRAP ===')
		print('>>> D0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])')
		D0 = ml.matrix([[0, 0, 0.13],[0, 0.6, 0.18],[0.31, 0.26, 0.02]])
		print('>>> D1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])')
		D1 = ml.matrix([[0, 1, -0.13],[0, 0.18, 0.04],[0.03, 0.09, 0.29]])
		print('>>> H0,H1 = DMAPFromDRAP(D0,D1)')
		H0,H1 = DMAPFromDRAP(D0,D1)
		print('>>> print(H0)')
		print(H0)
		print('>>> print(H1)')
		print(H1)
		print('>>> err = la.norm(LagkJointMomentsFromDRAP(D0,D1,3,1)-LagkJointMomentsFromDRAP(H0,H1,3,1))')
		err = la.norm(LagkJointMomentsFromDRAP(D0,D1,3,1)-LagkJointMomentsFromDRAP(H0,H1,3,1))
		print('>>> print(err)')
		print(err)
		print('=== DMMAPFromDMRAP ===')
		print('>>> H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.20, 0.17, 0.22],[0.19, 0.15, 0.16]])')
		H0 = ml.matrix([[0.15, 0.2, 0.18],[-0.20, 0.17, 0.22],[0.19, 0.15, 0.16]])
		print('>>> H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])')
		H1 = ml.matrix([[0.01, 0.08, 0.16],[0.02, 0.2, 0.07],[0.02, 0.15, 0.17]])
		print('>>> H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.31],[0.06, 0.1, 0]])')
		H2 = ml.matrix([[0.14, 0.07, 0.01],[0.19, 0.02, 0.31],[0.06, 0.1, 0]])
		print('>>> H = [H0,H1,H2]')
		H = [H0,H1,H2]
		print('>>> moms = MarginalMomentsFromDMRAP(H)')
		moms = MarginalMomentsFromDMRAP(H)
		print('>>> print(moms)')
		print(moms)
		print('>>> jmom = LagkJointMomentsFromDMRAP(H,3,1)')
		jmom = LagkJointMomentsFromDMRAP(H,3,1)
		print('>>> G = DMMAPFromDMRAP(H)')
		G = DMMAPFromDMRAP(H)
		print('>>> print(G[0])')
		print(G[0])
		print('>>> print(G[1])')
		print(G[1])
		print('>>> print(G[2])')
		print(G[2])
		print('>>> rmoms = MarginalMomentsFromDMMAP(G)')
		rmoms = MarginalMomentsFromDMMAP(G)
		print('>>> print(rmoms)')
		print(rmoms)
		print('>>> rjmom = LagkJointMomentsFromDMMAP(G,3,1)')
		rjmom = LagkJointMomentsFromDMMAP(G,3,1)
		print('>>> err = la.norm(rjmom[0]-jmom[0]) + la.norm(rjmom[1]-jmom[1])')
		err = la.norm(rjmom[0]-jmom[0]) + la.norm(rjmom[1]-jmom[1])
		print('>>> print(err)')
		print(err)
		print('=== CanonicalFromMAP2 ===')
		print('>>> D0 = ml.matrix([[0.46, 0.28],[0.35, 0.23]])')
		D0 = ml.matrix([[0.46, 0.28],[0.35, 0.23]])
		print('>>> D1 = ml.matrix([[0.08, 0.18],[0.14, 0.28]])')
		D1 = ml.matrix([[0.08, 0.18],[0.14, 0.28]])
		print('>>> H0,H1 = CanonicalFromDMAP2(D0,D1)')
		H0,H1 = CanonicalFromDMAP2(D0,D1)
		print('>>> print(H0)')
		print(H0)
		print('>>> print(H1)')
		print(H1)
		print('>>> Cm = SimilarityMatrix(H0,D0)')
		Cm = SimilarityMatrix(H0,D0)
		print('>>> err1 = la.norm(H0*Cm-Cm*D0)')
		err1 = la.norm(H0*Cm-Cm*D0)
		print('>>> err2 = la.norm(H1*Cm-Cm*D1)')
		err2 = la.norm(H1*Cm-Cm*D1)
		print('>>> print(np.max(err1,err2))')
		print(np.max(err1,err2))
		print('>>> D0 = ml.matrix([[0.26, 0.28],[0.35, 0.23]])')
		D0 = ml.matrix([[0.26, 0.28],[0.35, 0.23]])
		print('>>> D1 = ml.matrix([[0.28, 0.18],[0.14, 0.28]])')
		D1 = ml.matrix([[0.28, 0.18],[0.14, 0.28]])
		print('>>> H0,H1 = CanonicalFromDMAP2(D0,D1)')
		H0,H1 = CanonicalFromDMAP2(D0,D1)
		print('>>> print(H0)')
		print(H0)
		print('>>> print(H1)')
		print(H1)
		print('>>> Cm = SimilarityMatrix(H0,D0)')
		Cm = SimilarityMatrix(H0,D0)
		print('>>> err1 = la.norm(H0*Cm-Cm*D0)')
		err1 = la.norm(H0*Cm-Cm*D0)
		print('>>> err2 = la.norm(H1*Cm-Cm*D1)')
		err2 = la.norm(H1*Cm-Cm*D1)
		print('>>> print(np.max(err1,err2))')
		print(np.max(err1,err2))
		print('>>> D0 = ml.matrix([[0.14, 0.34],[0.35, 0.23]])')
		D0 = ml.matrix([[0.14, 0.34],[0.35, 0.23]])
		print('>>> D1 = ml.matrix([[0.22, 0.3],[0.28, 0.14]])')
		D1 = ml.matrix([[0.22, 0.3],[0.28, 0.14]])
		print('>>> H0,H1 = CanonicalFromDMAP2(D0,D1)')
		H0,H1 = CanonicalFromDMAP2(D0,D1)
		print('>>> print(H0)')
		print(H0)
		print('>>> print(H1)')
		print(H1)
		print('>>> Cm = SimilarityMatrix(H0,D0)')
		Cm = SimilarityMatrix(H0,D0)
		print('>>> err1 = la.norm(H0*Cm-Cm*D0)')
		err1 = la.norm(H0*Cm-Cm*D0)
		print('>>> err2 = la.norm(H1*Cm-Cm*D1)')
		err2 = la.norm(H1*Cm-Cm*D1)
		print('>>> print(np.max(err1,err2))')
		print(np.max(err1,err2))
		print('=== DMAP2FromMoments ===')
		print('>>> D0 = ml.matrix([[0.2, 0.7],[0.6, 0.1]])')
		D0 = ml.matrix([[0.2, 0.7],[0.6, 0.1]])
		print('>>> D1 = ml.matrix([[0.09, 0.01],[0.2, 0.1]])')
		D1 = ml.matrix([[0.09, 0.01],[0.2, 0.1]])
		print('>>> moms = MarginalMomentsFromDMAP(D0, D1, 3)')
		moms = MarginalMomentsFromDMAP(D0, D1, 3)
		print('>>> print(moms)')
		print(moms)
		print('>>> corr = LagCorrelationsFromDMAP(D0, D1, 1)[0]')
		corr = LagCorrelationsFromDMAP(D0, D1, 1)[0]
		print('>>> print(corr)')
		print(corr)
		print('>>> D0,D1 = DMAP2FromMoments(moms,corr)')
		D0,D1 = DMAP2FromMoments(moms,corr)
		print('>>> print(D0)')
		print(D0)
		print('>>> print(D1)')
		print(D1)
		print('>>> rmoms = MarginalMomentsFromDMAP(D0, D1, 3)')
		rmoms = MarginalMomentsFromDMAP(D0, D1, 3)
		print('>>> print(rmoms)')
		print(rmoms)
		print('>>> rcorr = LagCorrelationsFromDMAP(D0, D1, 1)[0]')
		rcorr = LagCorrelationsFromDMAP(D0, D1, 1)[0]
		print('>>> print(rcorr)')
		print(rcorr)
		print('=== SamplesFromDMAP ===')
		print('>>> D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])')
		D0 = ml.matrix([[0, 0.02, 0, 0],[0, 0.17, 0.2, 0.14],[0.16, 0.17, 0.02, 0.18],[0, 0, 0, 0.12]])
		print('>>> D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])')
		D1 = ml.matrix([[0, 0.88, 0.1, 0],[0.18, 0.07, 0.14, 0.1],[0.13, 0.15, 0.15, 0.04],[0.31, 0.18, 0.12, 0.27]])
		print('>>> x = SamplesFromDMAP(D0,D1,10000)')
		x = SamplesFromDMAP(D0,D1,10000)
		print('>>> mm = MarginalMomentsFromDMAP(D0,D1,3)')
		mm = MarginalMomentsFromDMAP(D0,D1,3)
		print('>>> print(mm)')
		print(mm)
		print('=== SamplesFromDMMAP ===')
		print('>>> D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])')
		D0 = ml.matrix([[0.34, 0, 0],[0.06, 0.05, 0.03],[0.11, 0.13, 0]])
		print('>>> D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])')
		D1 = ml.matrix([[0.3, 0, 0],[0.16, 0.18, 0.05],[0.15, 0.04, 0.09]])
		print('>>> D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])')
		D2 = ml.matrix([[0, 0.01, 0],[0.1, 0.07, 0.08],[0.13, 0.12, 0.13]])
		print('>>> D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])')
		D3 = ml.matrix([[0.35, 0, 0],[0, 0.18, 0.04],[0.06, 0.03, 0.01]])
		print('>>> D = [D0,D1,D2,D3]')
		D = [D0,D1,D2,D3]
		print('>>> x = SamplesFromDMMAP(D,10000)')
		x = SamplesFromDMMAP(D,10000)
		print('>>> mm = MarginalMomentsFromDMMAP(D,3)')
		mm = MarginalMomentsFromDMMAP(D,3)
		print('>>> print(mm)')
		print(mm)
	outFile.close()

if __name__ == "__main__":
	DMAPPythonGendocex()
