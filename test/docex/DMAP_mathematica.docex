"=== MarginalDistributionFromDMAP ==="
>>> D0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> {a, A} = MarginalDistributionFromDMAP[D0, D1];
>>> Print[a];
{0.2438770961395959, 0.4041227411783254, 0.19410324015415106, 0.15789692252792764}
>>> Print[A];
{{0, 0.02, 0, 0},
 {0, 0.17, 0.2, 0.14},
 {0.16, 0.17, 0.02, 0.18},
 {0, 0, 0, 0.12}}
"=== MarginalMomentsFromDMAP ==="
>>> D0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> moms = MarginalMomentsFromDMAP[D0, D1];
>>> Print[moms];
{1.4955358592094412, 2.9542479654368474, 7.885226907678561, 27.282328108669493, 116.17171481905851, 587.0447802480243, 3437.0301824147914}
"=== MarginalDistributionFromDRAP ==="
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1, -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> {a, A} = MarginalDistributionFromDRAP[H0, H1];
>>> Print[a];
{0.021493050580312315, 0.7125271919655068, 0.26597975745418073}
>>> Print[A];
{{0, 0, 0.13},
 {0, 0.6, 0.18},
 {0.31, 0.26, 0.02}}
"=== MarginalMomentsFromDRAP ==="
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1, -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> moms = MarginalMomentsFromDRAP[H0, H1];
>>> Print[moms];
{3.20702366840782, 16.897636691953394, 130.7705457435602, 1347.0743893905096, 17343.182467560622}
"=== MarginalDistributionFromDMMAP ==="
>>> D0 = {{0.34, 0, 0},{0.06, 0.05, 0.03},{0.11, 0.13, 0}};
>>> D1 = {{0.3, 0, 0},{0.16, 0.18, 0.05},{0.15, 0.04, 0.09}};
>>> D2 = {{0, 0.01, 0},{0.1, 0.07, 0.08},{0.13, 0.12, 0.13}};
>>> D3 = {{0.35, 0, 0},{0, 0.18, 0.04},{0.06, 0.03, 0.01}};
>>> {a, A} = MarginalDistributionFromDMMAP[{D0, D1, D2, D3}];
>>> Print[a];
{0.9616624523170234, 0.030651790446894853, 0.007685757236081784}
>>> Print[A];
{{0.34, 0, 0},
 {0.06, 0.05, 0.03},
 {0.11, 0.13, 0}}
"=== MarginalMomentsFromDMMAP ==="
>>> D0 = {{0.34, 0, 0},{0.06, 0.05, 0.03},{0.11, 0.13, 0}};
>>> D1 = {{0.3, 0, 0},{0.16, 0.18, 0.05},{0.15, 0.04, 0.09}};
>>> D2 = {{0, 0.01, 0},{0.1, 0.07, 0.08},{0.13, 0.12, 0.13}};
>>> D3 = {{0.35, 0, 0},{0, 0.18, 0.04},{0.06, 0.03, 0.01}};
>>> moms = MarginalMomentsFromDMMAP[{D0, D1, D2, D3}];
>>> Print[moms];
{1.503697331491185, 3.027841857350894, 8.424305390832199, 31.097386717744087, 143.8804184010114}
"=== MarginalDistributionFromDMRAP ==="
>>> H0 = {{0.15, 0.2, 0.18},{-0.23, 0.17, 0.22},{0.19, 0.15, 0.16}};
>>> H1 = {{0.01, 0.08, 0.16},{0.02, 0.2, 0.07},{0.02, 0.15, 0.17}};
>>> H2 = {{0.14, 0.07, 0.01},{0.19, 0.02, 0.34},{0.06, 0.1, 0}};
>>> {a, A} = MarginalDistributionFromDMRAP[{H0, H1, H2}];
>>> Print[a];
{0.22614580596765838, 0.3542378174211745, 0.4196163766111672}
>>> Print[A];
{{0.15, 0.2, 0.18},
 {-0.23, 0.17, 0.22},
 {0.19, 0.15, 0.16}}
"=== MarginalMomentsFromDMRAP ==="
>>> H0 = {{0.15, 0.2, 0.18},{-0.23, 0.17, 0.22},{0.19, 0.15, 0.16}};
>>> H1 = {{0.01, 0.08, 0.16},{0.02, 0.2, 0.07},{0.02, 0.15, 0.17}};
>>> H2 = {{0.14, 0.07, 0.01},{0.19, 0.02, 0.34},{0.06, 0.1, 0}};
>>> moms = MarginalMomentsFromDMRAP[{H0, H1, H2}];
>>> Print[moms];
{1.5947682612697014, 3.418532063993288, 9.959485592524356, 37.74236950164582, 177.12501064870213}
"=== LagCorrelationsFromDMAP ==="
>>> D0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> corr = LagCorrelationsFromDMAP[D0, D1, 3];
>>> Print[corr];
{-0.04585887310401268, 0.010753286512163932, -0.00479959597519405}
"=== LagCorrelationsFromDRAP ==="
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1, -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> corr = LagCorrelationsFromDRAP[H0, H1, 3];
>>> Print[corr];
{0.01430295723332723, 0.0012424024982963658, 7.586755398724169*^-6}
"=== LagkJointMomentsFromDMAP ==="
>>> D0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> Nm = LagkJointMomentsFromDMAP[D0, D1, 4, 1];
>>> Print[Nm];
{{1., 1.4955358592094412, 2.954247965436847, 7.885226907678559, 27.282328108669486},
 {1.4955358592094414, 2.2037182406034797, 4.282673397390962, 11.293317579798646, 38.82178903024472},
 {2.9542479654368474, 4.287487747878976, 8.189899409259828, 21.31527510118519, 72.75329018362508},
 {7.885226907678561, 11.326490281736413, 21.37905524531638, 55.129087442003616, 187.21290956791222},
 {27.282328108669493, 38.992776912604896, 73.17046611681856, 187.8221757842213, 636.2306227476095}}
>>> moms = MarginalMomentsFromDMAP[D0, D1, 4];
>>> Print[moms];
{1.4955358592094412, 2.9542479654368474, 7.885226907678561, 27.282328108669493}
>>> cjm = Table[0,{3}];
>>> Do[
>>>     Nx = LagkJointMomentsFromDMAP[D0, D1, 1, i];
>>>     cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);
>>> , {i,1,3,1}];
>>> Print[cjm];
{-0.045858873104012064, 0.010753286512164551, -0.00479959597519405}
>>> corr = LagCorrelationsFromDMAP[D0, D1, 3];
>>> Print[corr];
{-0.04585887310401268, 0.010753286512163932, -0.00479959597519405}
"=== LagkJointMomentsFromDRAP ==="
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1, -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> Nm = LagkJointMomentsFromDRAP[H0, H1, 4, 1];
>>> Print[Length[Nm]];
5
>>> moms = MarginalMomentsFromDRAP[H0, H1, 4];
>>> Print[moms];
{3.20702366840782, 16.897636691953394, 130.7705457435602, 1347.0743893905096}
>>> cjm = Table[0,{3}];
>>> Do[
>>>     Nx = LagkJointMomentsFromDRAP[H0, H1, 1, i];
>>>     cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);
>>> , {i,1,3,1}];
>>> Print[cjm];
{0.01430295723332723, 0.0012424024982963658, 7.5867553989928*^-6}
>>> corr = LagCorrelationsFromDRAP[H0, H1, 3];
>>> Print[corr];
{0.01430295723332723, 0.0012424024982963658, 7.586755398724169*^-6}
"=== LagkJointMomentsFromDMMAP ==="
>>> D0 = {{0.34, 0, 0},{0.06, 0.05, 0.03},{0.11, 0.13, 0}};
>>> D1 = {{0.3, 0, 0},{0.16, 0.18, 0.05},{0.15, 0.04, 0.09}};
>>> D2 = {{0, 0.01, 0},{0.1, 0.07, 0.08},{0.13, 0.12, 0.13}};
>>> D3 = {{0.35, 0, 0},{0, 0.18, 0.04},{0.06, 0.03, 0.01}};
>>> Nm = LagkJointMomentsFromDMMAP[{D0, D1, D2, D3}, 3, 1];
>>> Print[Nm[[1]]];
{{0.4539462822484643, 0.6852510653292481, 1.3856372122857255, 3.867050666477712},
 {0.6828250179169082, 1.0317922106199087, 2.088678354109492, 5.833872336896188},
 {1.3754547360883858, 2.08069063568443, 4.2170625241275665, 11.789140254269103},
 {3.8280196252781336, 5.795448856171304, 11.75638029642303, 32.88737375149565}}
>>> Print[Nm[[2]]];
{{0.02628103195085287, 0.03323044515488185, 0.05305519981654366, 0.11925159337093362},
 {0.0350514750959702, 0.04386614712772344, 0.06891661923475792, 0.15221701375061739},
 {0.06065278939554716, 0.07477024474361887, 0.11464021882832742, 0.24630981535186194},
 {0.1481969521134317, 0.17996016640440504, 0.269014437752629, 0.5607367898805973}}
>>> Print[Nm[[3]]];
{{0.5197726858006831, 0.7852158210070554, 1.5891494452486254, 4.438003130983554},
 {0.7858208384783067, 1.1881008368374677, 2.4066502002309207, 6.725367887552774},
 {1.5917343318669612, 2.4086996142807697, 4.883779522055594, 13.657165850576511},
 {4.448088813440633, 6.7353937552523435, 13.665836661211316, 38.234808402167886}}
"=== LagkJointMomentsFromDMRAP ==="
>>> H0 = {{0.15, 0.2, 0.18},{-0.23, 0.17, 0.22},{0.19, 0.15, 0.16}};
>>> H1 = {{0.01, 0.08, 0.16},{0.02, 0.2, 0.07},{0.02, 0.15, 0.17}};
>>> H2 = {{0.14, 0.07, 0.01},{0.19, 0.02, 0.34},{0.06, 0.1, 0}};
>>> Nm = LagkJointMomentsFromDMRAP[{H0, H1, H2}, 3, 2];
>>> Print[Nm[[1]]];
{{0.4879805825563548, 0.7804739995572898, 1.6784777723131161, 4.902860723736972},
 {0.7745778986519039, 1.2395315649453407, 2.6672632669482894, 7.794493672457849},
 {1.653860986909174, 2.648092315164064, 5.701611221347518, 16.66906590441337},
 {4.80922115249553, 7.70333279203901, 16.592926073643227, 48.52561424626535}}
>>> Print[Nm[[2]]];
{{0.5120194174436454, 0.8142942617124118, 1.7400542916801724, 5.0566248687873845},
 {0.820190362617798, 1.3035610054097582, 2.7836656770888917, 8.085263953193856},
 {1.764671077084115, 2.8029046012949106, 5.98142492574121, 17.364636197177674},
 {5.1502644400288276, 8.17696708018504, 17.441960447818936, 50.61882961114629}}
"=== RandomDMAP ==="
>>> {D0, D1} = RandomDMAP[4, 5.62, 10];
"CheckDMMAPRepresentation: One of the matrices has a negative element!"
>>> Print[D0];
{{0.21278221437828912, 0., 0., 0.},
 {0.011278949225403635, 0.8782232221839548, 0.0263469385273868, 0.022374631385683814},
 {0.0460749041054516, 0.047403838188409604, 0.6408645493969582, 0.060528300726468254},
 {0., 0., 0.009842703190542442, 0.4416331231263503}}
>>> Print[D1];
{{0., 0.2512887107901984, 0., 0.5359290748315126},
 {0.014434414872462123, 0.01640464789655152, 0.019554363456973523, 0.01138283245158379},
 {0., 0.0695379591979343, 0.0674256003171574, 0.0681648480676207},
 {0.13550179960811687, 0.37503634869415436, 0., 0.037986025380836085}}
>>> m = MarginalMomentsFromDMAP[D0, D1, 1][[1]];
>>> Print[m];
5.619999999999999
"=== RandomDMMAP ==="
>>> Dm = RandomDMMAP[4, 3, 5.62, 10];
"CheckDMMAPRepresentation: One of the matrices has a negative element!"
>>> Print[Dm[[1]]];
{{0.7072998175163537, 0.0330639349307332, 0.027081021596430496, 0.02385108161298766},
 {0.009891514917034798, 0.7552179245849459, 0.011941361786581367, 0.},
 {0.021124090552701084, 0.013796012248391028, 0.7419390913614541, 0.009584657858651528},
 {0.01652753706067554, 0.011289193479759773, 0.015322064720076528, 0.8468658465881937}}
>>> Print[Dm[[2]]];
{{0.00248253964768304, 0.0003058981603650573, 0.026303179350085984, 0.02801150296527193},
 {0.0027355499320486634, 0., 0.054438086753018734, 0.},
 {0.018787085975024508, 0.006077882909129739, 0.028445705812438268, 0.02840630865216939},
 {0.0059162068918948455, 0.003555109911971651, 0.018202119717824233, 0.020360435820448886}}
>>> Print[Dm[[3]]];
{{0., 0.015835430997682396, 0.02047745764156159, 0.025124598634568326},
 {0.04232880868618977, 0., 0., 0.},
 {0.024991175715566052, 0.018127198662412934, 0.026040865132466385, 0.008548150080449903},
 {0.0004893699832442725, 0.00152674833913999, 0.0068403963170084875, 0.002677062154166542}}
>>> Print[Dm[[4]]];
{{0.01999855402426914, 0.00697515663505612, 0.029661882058916206, 0.03352794422803513},
 {0.06576758149110849, 0., 0.04671459803157418, 0.010964573817498144},
 {0.023017033332286094, 0.006251279460061501, 0.015320619489275572, 0.009542842757522008},
 {0.017745914457866774, 0.007238301045600361, 0.016651581057964594, 0.008792112454163769}}
>>> m = MarginalMomentsFromDMMAP[Dm, 1][[1]];
>>> Print[m];
5.619999999999999
"=== CheckDMAPRepresentation ==="
>>> D0 = {{0, 0.02, 0},{0, 0.17, 0.2},{0.16, 0.17, 0.02}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> flag = CheckDMAPRepresentation[D0, D1];
"CheckDMAPRepresentation: D0 and D1 have different sizes!"
>>> Print[flag];
False
>>> D0 = {{0, 0.02, 0},{0, 0.17, 0.2},{0.16, 0.17, 0.02}};
>>> D1 = {{0, 0.88, 0.1},{0.18, 0.07, 0.14},{0.13, 0.15, 0.15}};
>>> flag = CheckDMAPRepresentation[D0, D1];
"CheckMAPRepresentation: A rowsum of D0+D1 is not 1 (at precision "1.*^-12")!"
>>> Print[flag];
False
>>> D0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> flag = CheckDMAPRepresentation[D0, D1];
>>> Print[flag];
True
"=== CheckDRAPRepresentation ==="
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02},{0.2, 0, 0}};
>>> H1 = {{0, 1., -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29},{0, 0.8, 0}};
>>> flag = CheckDRAPRepresentation[H0, H1];
"CheckDRAPRepresentation: D0 is not a quadratic matrix!"
>>> Print[flag];
False
>>> H0 = {{0.2, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1., -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> flag = CheckDRAPRepresentation[H0, H1];
"CheckDRAPRepresentation: A rowsum of D0+D1 is not 1! (precision:"1.*^-12")"
>>> Print[flag];
False
>>> H0 = {{-1., 0, 0},{0, -2., 2.},{0, 3., -3.}};
>>> H1 = {{0, 0, 1.},{0, -1., 1.},{1., 0, -1.}};
>>> flag = CheckDRAPRepresentation[H0, H1];
"CheckDRAPRepresentation: A rowsum of D0+D1 is not 1! (precision:"1.*^-12")"
>>> Print[flag];
False
>>> H0 = {{0, 0, 15.},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1., -15.},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> flag = CheckDRAPRepresentation[H0, H1];
"CheckDRAPRepresentation: The dominant eigenvalue of D0 is greater than 1!"
>>> Print[flag];
False
>>> H0 = {{0, 0.5, 0.1},{0, -1.4, 3.1},{0.67, 0, 0.4}};
>>> H1 = {{0, 0.4, 0},{0, -0.2, -0.5},{0.3, -0.7, 0.33}};
>>> flag = CheckDRAPRepresentation[H0, H1];
"CheckDRAPRepresentation: The dominant eigenvalue of D0 is complex!"
>>> Print[flag];
False
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1., -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> flag = CheckDRAPRepresentation[H0, H1];
>>> Print[flag];
True
"=== CheckDMMAPRepresentation ==="
>>> D0 = {{0.34, 0, 0},{0.06, 0.05, 0.03},{0.11, 0.13, 0}};
>>> D1 = {{0.3, 0, 0},{0.16, 0.18, 0.05},{0.15, 0.04, 0.09}};
>>> D2 = {{0, 0.01, 0},{0.1, 0.07, 0.08},{0.13, 0.12, 0.13}};
>>> D3 = {{0.35, 0, 0},{0, 0.18, 0.04},{0.06, 0.03, 0.01}};
>>> flag = CheckDMMAPRepresentation[{D0, D1, D2, D3}];
>>> Print[flag];
True
"=== CheckDMRAPRepresentation ==="
>>> H0 = {{0.15, 0.2, 0.18},{-0.23, 0.17, 0.22},{0.19, 0.15, 0.16}};
>>> H1 = {{0.01, 0.08, 0.16},{0.02, 0.2, 0.07},{0.02, 0.15, 0.17}};
>>> H2 = {{0.14, 0.07, 0.01},{0.19, 0.02, 0.34},{0.06, 0.1, 0}};
>>> flag = CheckDMRAPRepresentation[{H0, H1, H2}];
>>> Print[flag];
True
"=== DRAPFromMoments ==="
>>> G0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> G1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> moms = MarginalMomentsFromDRAP[G0, G1, 5];
>>> Print[moms];
{1.4955358592094412, 2.9542479654368474, 7.885226907678561, 27.282328108669493, 116.17171481905851}
>>> Nm = LagkJointMomentsFromDRAP[G0, G1, 2, 1];
>>> Print[Nm];
{{1., 1.4955358592094412, 2.954247965436847},
 {1.4955358592094414, 2.2037182406034797, 4.282673397390962},
 {2.9542479654368474, 4.287487747878976, 8.189899409259828}}
>>> {H0, H1} = DRAPFromMoments[moms, Nm];
>>> Print[H0];
{{0.5644738962225417, 0.47187846354848406, -0.6947446288880126},
 {-0.5085686970022437, -0.10550993297233946, 0.9592122034338286},
 {0.18477321176067846, 0.261205874785389, -0.13431385414476443}}
>>> Print[H1];
{{2.3993787625484853, 1.1243091633982, -2.865295656829698},
 {-1.7534589569688064, -0.5900943661745801, 2.9984197496841354},
 {0.9507424301490942, 0.5187877102745091, -0.7811953728249019}}
>>> rmoms = MarginalMomentsFromDRAP[H0, H1, 5];
>>> Print[rmoms];
{1.495535859209443, 2.954247965436855, 7.885226907678592, 27.28232810866962, 116.17171481905912}
>>> rNm = LagkJointMomentsFromDRAP[H0, H1, 2, 1];
>>> Print[rNm];
{{0.9999999999999997, 1.4955358592094425, 2.954247965436854},
 {1.4955358592094437, 2.2037182406034845, 4.282673397390974},
 {2.9542479654368594, 4.287487747878995, 8.189899409259864}}
"=== DMRAPFromMoments ==="
>>> G0 = {{0.34, 0, 0},{0.06, 0.05, 0.03},{0.11, 0.13, 0}};
>>> G1 = {{0.3, 0, 0},{0.16, 0.18, 0.05},{0.15, 0.04, 0.09}};
>>> G2 = {{0, 0.01, 0},{0.1, 0.07, 0.08},{0.13, 0.12, 0.13}};
>>> G3 = {{0.35, 0, 0},{0, 0.18, 0.04},{0.06, 0.03, 0.01}};
>>> G = {G0, G1, G2, G3};
>>> moms = MarginalMomentsFromDMRAP[G, 5];
>>> Print[moms];
{1.503697331491185, 3.027841857350894, 8.424305390832199, 31.097386717744087, 143.8804184010114}
>>> Nm = LagkJointMomentsFromDMRAP[G, 2, 1];
>>> {Nm1, Nm2, Nm3} = Nm;
>>> Print[Nm1];
{{0.4539462822484643, 0.6852510653292481, 1.3856372122857255},
 {0.6828250179169082, 1.0317922106199087, 2.088678354109492},
 {1.3754547360883858, 2.08069063568443, 4.2170625241275665}}
>>> Print[Nm2];
{{0.02628103195085287, 0.03323044515488185, 0.05305519981654366},
 {0.0350514750959702, 0.04386614712772344, 0.06891661923475792},
 {0.06065278939554716, 0.07477024474361887, 0.11464021882832742}}
>>> Print[Nm3];
{{0.5197726858006831, 0.7852158210070554, 1.5891494452486254},
 {0.7858208384783067, 1.1881008368374677, 2.4066502002309207},
 {1.5917343318669612, 2.4086996142807697, 4.883779522055594}}
>>> H = DMRAPFromMoments[moms, Nm];
>>> Print[H[[1]]];
{{0.06779513528098983, 0.6792233137807228, -0.42509134379512803},
 {-0.018716173794511234, 0.0035506821092199867, 0.3538644199083848},
 {-0.019901518585921547, 0.039924500868717246, 0.31865418278856805}}
>>> Print[H[[2]]];
{{0.1951207776434683, 1.6570695160216928, -1.5452971870081456},
 {-0.008100374639338296, 0.18194378529369715, 0.12657574230343016},
 {-0.007690549936086862, 0.115257691431907, 0.19293543687217607}}
>>> Print[H[[3]]];
{{0.2578685382565766, 3.834117264599513, -4.055530267739243},
 {0.12827076956352768, -1.350769988779902, 1.2347002335875743},
 {0.12665640477215312, -1.4076139251314146, 1.2929014505253633}}
>>> Print[H[[4]]];
{{0.1744074874552913, -0.11574488139467576, 0.27606164689950674},
 {-0.014005700448463549, -0.013671167607753887, 0.3763577725021605},
 {-0.012887066531690031, -0.01750028735204978, 0.3792636802754714}}
>>> BuTools`CheckPrecision = 10.^-10;
>>> rmoms = MarginalMomentsFromDMRAP[H, 5];
>>> Print[rmoms];
{1.5036973314912396, 3.0278418573511203, 8.424305390833059, 31.09738671774769, 143.88041840102892}
>>> rNm = LagkJointMomentsFromDMRAP[H, 2, 1];
>>> {rNm1, rNm2, rNm3} = rNm;
>>> Print[rNm1];
{{0.4539462822461965, 0.6852510653258723, 1.3856372122790048},
 {0.6828250179124524, 1.0317922106132444, 2.0886783540961558},
 {1.3754547360759344, 2.080690635665735, 4.217062524089992}}
>>> Print[rNm2];
{{0.026281031950898093, 0.033230445154958294, 0.053055199816716886},
 {0.03505147509598383, 0.043866147127753385, 0.06891661923484005},
 {0.06065278939548402, 0.07477024474353555, 0.11464021882818698}}
>>> Print[rNm3];
{{0.519772685800297, 0.7852158210065349, 1.5891494452477044},
 {0.7858208384782196, 1.1881008368374257, 2.406650200231027},
 {1.5917343318688073, 2.408699614283732, 4.88377952206196}}
>>> Print[Norm[moms-rmoms]];
1.7896738102973677*^-11
"=== DMAPFromDRAP ==="
>>> H0 = {{0, 0, 0.13},{0, 0.6, 0.18},{0.31, 0.26, 0.02}};
>>> H1 = {{0, 1, -0.13},{0, 0.18, 0.04},{0.03, 0.09, 0.29}};
>>> {D0, D1} = DMAPFromDRAP[H0, H1];
>>> Print[D0];
{{0.051945258246527765, 0.0663208007812501, 0.1270425829475309},
 {0.011716991785622438, 0.5674492730034719, 0.294436844493027},
 {0.41438232421874993, 0.17501220703124998, 0.0006054687500000044}}
>>> Print[D1];
{{0.08564787688078702, 0.6466430664062499, 0.022400414737654306},
 {0.005443444439086077, 0.08913727936921295, 0.031816166909579335},
 {0.046560058593749995, 0.06822509765625, 0.29521484375}}
>>> err = Norm[LagkJointMomentsFromDRAP[D0, D1, 3, 1]-LagkJointMomentsFromDRAP[H0, H1, 3, 1]];
>>> Print[err];
9.562315040162238*^-11
"=== DMMAPFromDMRAP ==="
>>> H0 = {{0.15, 0.2, 0.18},{-0.20, 0.17, 0.22},{0.19, 0.15, 0.16}};
>>> H1 = {{0.01, 0.08, 0.16},{0.02, 0.2, 0.07},{0.02, 0.15, 0.17}};
>>> H2 = {{0.14, 0.07, 0.01},{0.19, 0.02, 0.31},{0.06, 0.1, 0.}};
>>> H = {H0, H1, H2};
>>> moms = MarginalMomentsFromDMRAP[H];
>>> Print[moms];
{1.6263896740154515, 3.6054695734649638, 10.991320699229345, 43.90287088124943, 218.07910677758852}
>>> jmom = LagkJointMomentsFromDMRAP[H, 3, 1];
>>> G = DMMAPFromDMRAP[H];
>>> Print[G[[1]]];
{{0.12149271422840599, 0.288331581363331, 0.11967700564930148},
 {5.644084212797836*^-6, 0.17495249080494266, 0.06839214007006354},
 {0.14666783363741778, 0.12596472732550704, 0.1835547949666508}}
>>> Print[G[[2]]];
{{0.026094910703667897, 5.787995863058259*^-6, 0.1305322742733941},
 {0.06906174782798843, 0.269261673646175, 0.000011436233267865314},
 {0.07372525075569406, 0.21205253223976755, 0.08464341565015684}}
>>> Print[G[[3]]];
{{0.14938972761188077, 0.0019470730142651345, 0.16252892515988945},
 {0.12377266142377177, 0.010575633044980423, 0.2839665728645965},
 {0.047621973820317604, 0.1257348322613494, 0.000034639343138560594}}
>>> rmoms = MarginalMomentsFromDMMAP[G];
>>> Print[rmoms];
{1.6263896740154504, 3.6054695734649584, 10.991320699229316, 43.902870881249264, 218.0791067775875}
>>> rjmom = LagkJointMomentsFromDMMAP[G, 3, 1];
>>> err = Norm[rjmom[[1]]-jmom[[1]]]+Norm[rjmom[[2]]-jmom[[2]]];
>>> Print[err];
8.133031677833887*^-13
"=== CanonicalFromDMAP2 ==="
>>> D0 = {{0.46, 0.28},{0.35, 0.23}};
>>> D1 = {{0.08, 0.18},{0.14, 0.28}};
>>> {H0, H1} = CanonicalFromDMAP2[D0, D1];
>>> Print[H0];
{{0.6785041229130464, 0.31704085460114795},
 {0, 0.011495877086969752}}
>>> Print[H1];
{{0, 0.004455022485805612},
 {0.6285041229130266, 0.3600000000000036}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
8.953600966260704*^-14
>>> D0 = {{0.26, 0.28},{0.35, 0.23}};
>>> D1 = {{0.28, 0.18},{0.14, 0.28}};
>>> {H0, H1} = CanonicalFromDMAP2[D0, D1];
>>> Print[H0];
{{0.4900000000000001, 0.38874507866387564},
 {0.09826490956822952, 0}}
>>> Print[H1];
{{0.12125492133612426, 0},
 {0.462990011767894, 0.4387450786638765}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
2.6634419263318992*^-14
>>> D0 = {{0.14, 0.34},{0.35, 0.23}};
>>> D1 = {{0.22, 0.3},{0.28, 0.14}};
>>> {H0, H1} = CanonicalFromDMAP2[D0, D1];
>>> Print[H0];
{{0.37, 0.5173403532281082},
 {0.16778122846668353, 0}}
>>> Print[H1];
{{0, 0.11265964677189179},
 {0.4722187715333161, 0.3600000000000004}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
5.0785547211252284*^-15
"=== DMAP2FromMoments ==="
>>> D0 = {{0.2, 0.7},{0.6, 0.1}};
>>> D1 = {{0.09, 0.01},{0.2, 0.1}};
>>> moms = MarginalMomentsFromDMAP[D0, D1, 3];
>>> Print[moms];
{5.15358361774744, 46.58703071672353, 626.4505119453922}
>>> corr = LagCorrelationsFromDMAP[D0, D1, 1][[1]];
>>> Print[corr];
-0.0008028615465149905
>>> {D0, D1} = DMAP2FromMoments[moms, corr];
>>> Print[D0];
{{0.29999999999984595, 0.6500000000001445},
 {0.6153846153846679, 0}}
>>> Print[D1];
{{0.050000000000009585, 0},
 {0.24461538461532123, 0.14000000000001087}}
>>> rmoms = MarginalMomentsFromDMAP[D0, D1, 3];
>>> Print[rmoms];
{5.153583617747385, 46.58703071672293, 626.4505119453836}
>>> rcorr = LagCorrelationsFromDMAP[D0, D1, 1][[1]];
>>> Print[rcorr];
-0.0008028615465146371
"=== SamplesFromDMAP ==="
>>> D0 = {{0, 0.02, 0, 0},{0, 0.17, 0.2, 0.14},{0.16, 0.17, 0.02, 0.18},{0, 0, 0, 0.12}};
>>> D1 = {{0, 0.88, 0.1, 0},{0.18, 0.07, 0.14, 0.1},{0.13, 0.15, 0.15, 0.04},{0.31, 0.18, 0.12, 0.27}};
>>> x = SamplesFromDMAP[D0, D1, 10000];
>>> mt = MarginalMomentsFromTrace[x, 3];
>>> Print[mt];
{1.4863000000000002, 2.9109000000000003, 7.666300000000001}
>>> mm = MarginalMomentsFromDMAP[D0, D1, 3];
>>> Print[mm];
{1.4955358592094412, 2.9542479654368474, 7.885226907678561}
"=== SamplesFromDMMAP ==="
>>> D0 = {{0.34, 0, 0},{0.06, 0.05, 0.03},{0.11, 0.13, 0}};
>>> D1 = {{0.3, 0, 0},{0.16, 0.18, 0.05},{0.15, 0.04, 0.09}};
>>> D2 = {{0, 0.01, 0},{0.1, 0.07, 0.08},{0.13, 0.12, 0.13}};
>>> D3 = {{0.35, 0, 0},{0, 0.18, 0.04},{0.06, 0.03, 0.01}};
>>> Dm = {D0, D1, D2, D3};
>>> x = SamplesFromDMMAP[Dm, 10000];
>>> mt = MarginalMomentsFromTrace[x[[1;;-1, 1]], 3];
>>> Print[mt];
{1.5006000000000002, 2.995, 8.1678}
>>> mm = MarginalMomentsFromDMMAP[Dm, 3];
>>> Print[mm];
{1.503697331491185, 3.027841857350894, 8.424305390832199}
